<!DOCTYPE html>
<html>
<head>
	<title>Questionnaire</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.0/css/bulma.css">
    <style>
		#bg {
			position: fixed;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			background-size: cover;
			filter: blur(5px);
		}
		.center-screen {
			display: flex;
			justify-content: center;
			align-items: center;
			text-align: center;
			min-height: 100vh;
		}
		.fixed-to-bottom {
			position: fixed;
			bottom: 0;
			left: 0;
			width: 100%;
      }
	</style>	
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
	<div id="bg"></div>

	<nav class="navbar" role="navigation" aria-label="main navigation">
		<div class="navbar-brand">
		  <a class="navbar-item" href="https://bulma.io">
			<img src="https://www.chiropraticavinci.it/wp-content/uploads/2019/07/logoVinciMobile-08.png" width="152" height="35">
		  </a>
	  
		  <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
			<span aria-hidden="true"></span>
			<span aria-hidden="true"></span>
			<span aria-hidden="true"></span>
		  </a>
		</div>
	  
		<div id="navbarBasicExample" class="navbar-menu">
		  <div class="navbar-start">
			<a class="navbar-item" href="https://www.chiropraticavinci.it">
			  Home
			</a>
			<div class="navbar-item has-dropdown is-hoverable">
			  <a class="navbar-link">
				Info
			  </a>
			  <div class="navbar-dropdown">
				<a class="navbar-item">
				  Scopo del questionario
				</a>
				<a class="navbar-item">
				  Contatti
				</a>
				<hr class="navbar-divider">
				<a class="navbar-item">
				  Supporto
				</a>
			  </div>
			</div>
		  </div>
	  
		  <div class="navbar-end">
			<div class="navbar-item">
			  <div class="buttons">
				<a id="exit" class="button is-danger">
				  Esci
				</a>
			  </div>
			</div>
		  </div>
		</div>
	  </nav>

	<div id="non-submittable-popup" class="modal">
		<div class="modal-background"></div>
			<div class="modal-card">
			<header class="modal-card-head">
				<p class="modal-card-title">Attenzione!</p>
				<button class="delete close-non-submittable-popup" aria-label="close"></button>
			</header>
			<section class="modal-card-body">
				<h2>Rispondi prima a tutte le domande</h2>
			</section>
			<footer class="modal-card-foot">
				<button class="button is-success close-non-submittable-popup">OK</button>
			</footer>
		</div>
	</div>
	<div id="thanks-for-submitting-popup" class="modal">
		<div class="modal-background"></div>
			<div class="modal-card">
			<header class="modal-card-head">
				<p class="modal-card-title is-link">Grazie per averci inviato le tue risposte!</p>
				<button class="delete close-thanks-for-submitting-popup" aria-label="close"></button>
			</header>
			<section class="modal-card-body">
				<h2>Per noi è importante tenere traccia dei progressi e delle difficoltà <strong>dei nostri pazienti.<strong></h2>
				<h2> Rispondendo al quastionario <strong>hai contribuito al miglioramento</strong> del servizio che offriamo a tutti i pazienti.</h2>
			</section>
			<footer class="modal-card-foot">
				<button class="button is-success close-thanks-for-submitting-popup">Chiudi</button>
			</footer>
		</div>
	</div>

	<div id="notification" class="notification is-primary">
		<button id="close-notification" class="delete"></button>
		<div class="block">
			Benvenuto/a nel nostro <strong>questionario</strong> periodico!<br/>
			Ti invitiamo a rispondere alle <strong>domande</strong> che sono presentate di seguito.
			Le risposte anonime saranno registrate per fornire un resoconto statistico dei progressi generati dalle <strong>terapie</strong>.
		</div>
		<div class="block">
			Grazie per la tua <strong>collaborazione</strong>!
		</div>
	</div>
	

	<section class="section">
		<div class="container">
			<div class="columns is-centered">
			  <div class="column is-half">
				<form id="questionnaire">
					Domande: <span id="progress-label">0</span>/10
					<progress id="progress-bar" class="progress is-link" value="0" max="100"></progress>
					<div id="page_1">
						<div class="card">
							<div class="card-content">
							<div class="content">
								<h3>1. In generale direbbe che la Sua salute è… </h3>
								<label><input type="radio" name="q1" value="1a"> Buona</label><br/>
								<label><input type="radio" name="q1" value="1b"> Passabile</label><br/>
								<label><input type="radio" name="q1" value="1c"> Scadente</label><br/>
							</div>
					 	   </div>
						</div><br/>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>2. Rispetto a un anno fa, come giudicherebbe, ora, la Sua salute in generale?</h3>
									<label><input type="radio" name="q2" value="2a"> Migliore</label><br/>
									<label><input type="radio" name="q2" value="2b"> Uguale</label><br/>
									<label><input type="radio" name="q2" value="2c"> Peggiore</label><br/>
								</div>
						    </div>
						</div><br/>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>3. Fatica a fare attivita' come portare la spesa, salire le scale, passare l'aspirapolvere?</h3>
									<label><input type="radio" name="q3" value="3a"> No</label><br/>
									<label><input type="radio" name="q3" value="3b"> Un poco</label><br/>
									<label><input type="radio" name="q3" value="3c"> Si</label><br/>
							    </div>
						   </div>
						</div><br/>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>4. Riesce a fare il bagno e verstirsi da sola/o?</h3>
									<label><input type="radio" name="q4" value="4a"> Decisamente si</label><br/>
									<label><input type="radio" name="q4" value="4b"> Con qualche difficoltà</label><br/>
									<label><input type="radio" name="q4" value="4c"> No</label><br/>
								</div>
							</div>
						</div>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>5. Prende medicinali antidolorifici o antinfiammatori? </h3>
									<label><input type="radio" name="q5" value="5a"> Con regolarità</label><br/>
									<label><input type="radio" name="q5" value="5b"> Di tanto in tanto</label><br/>
									<label><input type="radio" name="q5" value="5c"> Molto raramente</label><br/>
								</div>
						    </div>
						</div><br/>
						
						<!--button id="go_to_page_1_from_page_1" class="button is-warning">Precedente</button-->
						<button id="go_to_page_2_from_page_1" class="button is-success">Prossima</button><br/><br/><br/>
					</div>
					<div id="page_2">
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>6. Fa attivita fisica?</h3>
									<label><input type="radio" name="q6" value="6a"> Regolarmente</label><br/>
									<label><input type="radio" name="q6" value="6b"> Ogni tanto</label><br/>
									<label><input type="radio" name="q6" value="6c"> Quasi mai</label><br/>
								</div>
							</div>
						</div><br/>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>7. Ha problemi di digestione?</h3>
									<label><input type="radio" name="q7" value="7a"> Quasi ogni giorno</label><br/>
									<label><input type="radio" name="q7" value="7b"> Ogni tanto quando mangio pesante</label><br/>
									<label><input type="radio" name="q7" value="7c"> Quasi mai</label><br/>
								</div>
							</div>
						</div><br/>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>8. Sente bruciore nella schiena quando si alza la mattina?</h3>
									<label><input type="radio" name="q8" value="8a"> Sempre</label><br/>
									<label><input type="radio" name="q8" value="8b"> Ogni tanto</label><br/>
									<label><input type="radio" name="q8" value="8c"> Quasi mai</label><br/>
								</div>
							</div>
						</div><br/>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>9. È stato mai sottoposto a trattamenti basati su miorilassanti?</h3>
									<label><input type="radio" name="q9" value="9a"> Li uso spesso</label><br/>
									<label><input type="radio" name="q9" value="9b"> Sì, mi è capitato</label><br/>
									<label><input type="radio" name="q9" value="9c"> Mai</label><br/>
								</div>
							</div>
						</div><br/>
						<div class="card">
							<div class="card-content">
								<div class="content">
									<h3>10. Fa delle diete particolari?</h3>
									<label><input type="radio" name="q10" value="10a"> No, nessuna</label><br/>
									<label><input type="radio" name="q10" value="10b"> Seguo l'alimentazione vegana</label><br/>
									<label><input type="radio" name="q10" value="10c"> Seguo i consigli di un nutrizionista</label><br/>
								</div>
							</div>
						</div>
						<br/>
						<button id="go_to_page_1_from_page_2" class="button is-warning">Precedente</button>
						<!--button id="go_to_page_2_from_page_2" class="button is-success">Prossima</button-->
						<br><br>
						<div class="control">
							<button type="submit" value="Submit" class="button is-info">
								Invia risposte
							</button>
						</div>
					</div>
				</form>
			  </div>
			</div>
		</div>
	</section>
	<div id="footer" class="notification is-primary">
		<div class="block">
			Copyright <strong>Vinci Chiropratica S.r.l.</strong> anno 2023<br/>
			Powered by <strong>Bulma CSS</strong>
		</div><br/><br/>
	</div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.birds.min.js"></script>
	<script>
	VANTA.BIRDS({
	  el: "#bg",
	  mouseControls: true,
	  touchControls: false,
	  gyroControls: false,
	  minHeight: 1700.00,
	  minWidth: 500.00,
	  scale: 1.00,
	  scaleMobile: 1.00,
	  forceAnimate: true,
	  color1: 0x6ba1ac,
      color2: 0x7f6000,
	  backgroundColor: 0xCCFFF2
	})
	</script>
	
	<script>
		var responses = [];
		var progress = 0;
		var page = 1;

		$(document).ready(function(){
			$("#page_1").show();
			$("#page_2").hide();
		});

		$("#go_to_page_1_from_page_1").click(function(e) {
            e.preventDefault();
	        $("#page_1").show();
			$("#page_2").hide();
        });

		$("#go_to_page_2_from_page_1").click(function(e) {
            e.preventDefault();
	        $("#page_1").hide();
			$("#page_2").show();
        });

		$("#go_to_page_1_from_page_2").click(function(e) {
            e.preventDefault();
	        $("#page_1").show();
			$("#page_2").hide();
        });

		$("#go_to_page_2_from_page_2").click(function(e) {
            e.preventDefault();
	        $("#page_1").hide();
			$("#page_2").show();
        });

		$("#close-notification").click(function(e) {
			$("#notification").hide();
		});

		$(".close-non-submittable-popup").click(function(e) {
			$("#non-submittable-popup").removeClass("is-active");
		});

		$(".close-thanks-for-submitting-popup").click(function() {
			$("#thanks-for-submitting-popup").removeClass("is-active");
			window.open("https://www.chiropraticavinci.it", "_blank");
            window.close();
        });

		$("#close-notification").click(function(e) {
			$("#notification").hide();
		});

		function submitForm() {
			let progressElem = document.getElementById("progress-bar");
			if (parseInt(progressElem.value) != 100) {
				$("#non-submittable-popup").addClass("is-active");
				return
			} else {
				$("#thanks-for-submitting-popup").addClass("is-active");
				return
			}
			
			console.log(responses)
			var timestamp = new Date().toISOString(); // Get current timestamp in ISO format
			var user_id = "12345"; // Example user ID

			var data = {
				datetime: timestamp,
				user_id: user_id,
				responses: responses
			};
			
			var xhr = new XMLHttpRequest();
			xhr.open("POST", "http://localhost:8080");
			xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
			xhr.send(JSON.stringify(data));
		}

		function increaseProgressBarValue() {
			let progressElem = document.getElementById("progress-bar");
            let newProgressValue = parseInt(progressElem.value) + 10;
            progressElem.setAttribute("value", newProgressValue);
			progress++
			$("#progress-label").text(progress);
		}

		$("input[name=q1]").click(function() {
			if (responses[0] == undefined) {
				increaseProgressBarValue();
			}
			responses[0] = $(this).val();
		});
		$("input[name=q2]").click(function() {
			if (responses[1] == undefined) {
				increaseProgressBarValue();
			}
			responses[1] = $(this).val();
		});
		$("input[name=q3]").click(function() {
			if (responses[2] == undefined) {
				increaseProgressBarValue();
			}
			responses[2] = $(this).val();
		});
		$("input[name=q4]").click(function() {
			if (responses[3] == undefined) {
				increaseProgressBarValue();
			}
			responses[3] = $(this).val();
		});
		$("input[name=q5]").click(function() {
			if (responses[4] == undefined) {
				increaseProgressBarValue();
			}
			responses[4] = $(this).val();
		});
		$("input[name=q6]").click(function() {
			if (responses[5] == undefined) {
				increaseProgressBarValue();
			}
			responses[5] = $(this).val();
		});
		$("input[name=q7]").click(function() {
			if (responses[6] == undefined) {
				increaseProgressBarValue();
			}
			responses[6] = $(this).val();
		});
		$("input[name=q8]").click(function() {
			if (responses[7] == undefined) {
				increaseProgressBarValue();
			}
			responses[7] = $(this).val();
		});
		$("input[name=q9]").click(function() {
			if (responses[8] == undefined) {
				increaseProgressBarValue();
			}
			responses[8] = $(this).val();
		});
		$("input[name=q10]").click(function() {
			if (responses[9] == undefined) {
				increaseProgressBarValue();
			}
			responses[9] = $(this).val();
		});

		// event handler for form submission
		$("#questionnaire").submit(function(event) {
			event.preventDefault(); // prevent default form submission
			submitForm();
		});

		$("#exit").click(function(e) {
          e.preventDefault();
          window.location.replace("login.html");
        });
	</script>
</body>
</html>

